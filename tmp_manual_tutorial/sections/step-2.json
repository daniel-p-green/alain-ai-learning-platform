{
  "section_number": 2,
  "title": "Step 2: Scaffold the Project and Wire Poe",
  "estimated_tokens": 420,
  "callouts": [
    {
      "type": "tip",
      "message": "Pin `openai` \u2265 4.57.0; earlier builds lack the streaming helpers used here."
    }
  ],
  "content": [
    {
      "cell_type": "markdown",
      "source": "### Why this step matters\n\nWe need a reproducible Next.js workspace with TypeScript, ESLint, and the OpenAI SDK already pointing at Poe. The cell below bootstraps the project and writes the base config files we will extend in later steps.\n\nMake sure you run this from a clean directory (the script creates `poe-chat-tutorial/`)."
    },
    {
      "cell_type": "code",
      "source": "%%bash\nset -euo pipefail\nmkdir -p poe-chat-tutorial/app/api/chat\nmkdir -p poe-chat-tutorial/app/components\nmkdir -p poe-chat-tutorial/components\nmkdir -p poe-chat-tutorial/lib\nmkdir -p poe-chat-tutorial/tests\ncat <<'EOF' > poe-chat-tutorial/package.json\n{\n  \"name\": \"poe-chat-tutorial\",\n  \"version\": \"0.1.0\",\n  \"private\": true,\n  \"type\": \"module\",\n  \"scripts\": {\n    \"dev\": \"next dev\",\n    \"build\": \"next build\",\n    \"start\": \"next start\",\n    \"lint\": \"next lint\",\n    \"test\": \"vitest run\"\n  },\n  \"dependencies\": {\n    \"next\": \"14.2.4\",\n    \"openai\": \"4.57.0\",\n    \"react\": \"18.3.1\",\n    \"react-dom\": \"18.3.1\"\n  },\n  \"devDependencies\": {\n    \"@types/node\": \"20.17.6\",\n    \"@types/react\": \"18.3.11\",\n    \"@types/react-dom\": \"18.3.0\",\n    \"eslint\": \"8.57.1\",\n    \"eslint-config-next\": \"14.2.4\",\n    \"typescript\": \"5.6.3\",\n    \"vitest\": \"1.6.1\"\n  }\n}\nEOF\ncat <<'EOF' > poe-chat-tutorial/tsconfig.json\n{\n  \"compilerOptions\": {\n    \"target\": \"ES2020\",\n    \"lib\": [\n      \"dom\",\n      \"dom.iterable\",\n      \"es2021\"\n    ],\n    \"allowJs\": false,\n    \"skipLibCheck\": true,\n    \"strict\": true,\n    \"forceConsistentCasingInFileNames\": true,\n    \"noEmit\": true,\n    \"esModuleInterop\": true,\n    \"module\": \"ESNext\",\n    \"moduleResolution\": \"Bundler\",\n    \"baseUrl\": \".\",\n    \"paths\": {\n      \"@/*\": [\n        \"./*\"\n      ]\n    },\n    \"resolveJsonModule\": true,\n    \"isolatedModules\": true,\n    \"jsx\": \"preserve\",\n    \"incremental\": true,\n    \"types\": [\n      \"vitest/globals\"\n    ],\n    \"plugins\": [\n      {\n        \"name\": \"next\"\n      }\n    ]\n  },\n  \"include\": [\n    \"next-env.d.ts\",\n    \"**/*.ts\",\n    \"**/*.tsx\",\n    \".next/types/**/*.ts\"\n  ],\n  \"exclude\": [\n    \"node_modules\"\n  ]\n}\nEOF\ncat <<'EOF' > poe-chat-tutorial/next.config.mjs\n/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  reactStrictMode: true\n};\n\nexport default nextConfig;\nEOF\ncat <<'EOF' > poe-chat-tutorial/next-env.d.ts\n/// <reference types=\"next\" />\n/// <reference types=\"next/image-types/global\" />\n\n// NOTE: This file should not be edited\n// see https://nextjs.org/docs/basic-features/typescript for more information.\nEOF\ncat <<'EOF' > poe-chat-tutorial/.eslintrc.json\n{\n  \"extends\": [\"next/core-web-vitals\"]\n}\nEOF\ncat <<'EOF' > poe-chat-tutorial/app/globals.css\n:root {\n  color-scheme: light dark;\n  font-family: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;\n  line-height: 1.5;\n  font-weight: 400;\n}\n\n* {\n  box-sizing: border-box;\n}\n\nbody {\n  margin: 0;\n  background: #0f172a;\n  color: #f8fafc;\n}\n\na {\n  color: inherit;\n  text-decoration: none;\n}\n\nmain {\n  padding: 2.5rem 1.5rem;\n  max-width: 960px;\n  margin: 0 auto;\n}\n\n.card {\n  background: rgba(15, 23, 42, 0.85);\n  border: 1px solid rgba(148, 163, 184, 0.2);\n  border-radius: 18px;\n  padding: 1.5rem;\n  margin-bottom: 1.5rem;\n  box-shadow: 0 10px 25px rgba(15, 23, 42, 0.35);\n}\n\nbutton, select {\n  font: inherit;\n}\n\ntextarea {\n  width: 100%;\n  min-height: 120px;\n  resize: vertical;\n  padding: 0.75rem;\n  border-radius: 12px;\n  border: 1px solid rgba(148, 163, 184, 0.35);\n  background: rgba(15, 23, 42, 0.8);\n  color: inherit;\n}\n\n.chat-container {\n  border-radius: 14px;\n  border: 1px solid rgba(148, 163, 184, 0.25);\n  background: rgba(15, 23, 42, 0.65);\n  padding: 1rem;\n  max-height: 420px;\n  overflow-y: auto;\n}\n\n.chat-message {\n  margin-bottom: 1rem;\n}\n\n.chat-message strong {\n  display: block;\n  margin-bottom: 0.25rem;\n}\n\n.telemetry-list {\n  list-style: none;\n  padding: 0;\n  margin: 0;\n  display: grid;\n  gap: 0.75rem;\n}\n\n.telemetry-list li {\n  border-radius: 12px;\n  border: 1px solid rgba(148, 163, 184, 0.25);\n  padding: 0.75rem 1rem;\n  background: rgba(15, 23, 42, 0.55);\n}\n\n.status-pill {\n  display: inline-flex;\n  align-items: center;\n  gap: 0.5rem;\n  border-radius: 999px;\n  padding: 0.35rem 0.75rem;\n  font-size: 0.75rem;\n  text-transform: uppercase;\n  letter-spacing: 0.04em;\n}\n\n.status-pill.active {\n  background: rgba(34, 197, 94, 0.12);\n  color: #4ade80;\n}\n\n.status-pill.idle {\n  background: rgba(148, 163, 184, 0.2);\n  color: #cbd5f5;\n}\n\n.callout {\n  border-left: 4px solid #38bdf8;\n  background: rgba(14, 116, 144, 0.22);\n  padding: 0.75rem 1rem;\n  border-radius: 12px;\n  margin-bottom: 1rem;\n}\n\n.callout.warning {\n  border-left-color: #f97316;\n  background: rgba(249, 115, 22, 0.18);\n}\nEOF\ncat <<'EOF' > poe-chat-tutorial/app/layout.tsx\nimport type { Metadata } from \"next\";\nimport \"./globals.css\";\n\nexport const metadata: Metadata = {\n  title: \"Poe Multi-Model Chat Tutorial\",\n  description: \"Learn to build a streaming chat UI with Poe-hosted models and telemetry instrumentation.\"\n};\n\nexport default function RootLayout({ children }: { children: React.ReactNode }) {\n  return (\n    <html lang=\"en\">\n      <body>\n        <main>{children}</main>\n      </body>\n    </html>\n  );\n}\nEOF"
    },
    {
      "cell_type": "code",
      "source": "%%bash\nset -euo pipefail\ncd poe-chat-tutorial\nnpm install"
    },
    {
      "cell_type": "markdown",
      "source": "After the install finishes, add your secrets to an `.env.local` file so Next.js can load them automatically:\n\n```bash\ncd poe-chat-tutorial\ncat <<'ENV' > .env.local\nPOE_API_KEY=sk-your-key\nNEXT_PUBLIC_POE_DEFAULT_MODEL=gpt-oss-20b\nENV\n```\n\n`.env.local` stays outside source control, so your `POE_API_KEY` remains private while every command (`npm run dev`, tests, notebook cells) reads the same configuration."
    }
  ]
}
